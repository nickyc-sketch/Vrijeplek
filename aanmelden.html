<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Aanmelden — Vrijeplek</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css?v=ocean">

  <style>
    .site-header::after{content:"";position:absolute;inset:auto 0 0 0;height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.45),transparent);opacity:.6;}
    .section-title{display:flex;align-items:center;gap:10px;justify-content:center;margin:8px auto 22px;color:var(--blue-900);}
    .section-title::before,.section-title::after{content:"";flex:1 1 100px;height:1px;background:linear-gradient(90deg,transparent,rgba(26,102,255,.25),transparent);}
    .search-wrap{max-width:820px;margin-inline:auto;padding:18px;}
    .card-head{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 16px 12px;margin:-10px -10px 12px -10px;border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,.65),rgba(255,255,255,.35)),linear-gradient(120deg,rgba(26,102,255,.18),rgba(0,86,255,.28));border:1px solid rgba(26,102,255,.28);box-shadow:inset 0 1px 0 rgba(255,255,255,.55);}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px;background:linear-gradient(180deg,#fff,#f5f9ff);border:1px solid rgba(26,102,255,.28);box-shadow:0 4px 12px rgba(10,27,90,.10);color:var(--blue-900);white-space:nowrap;}
    .badge-dot{width:8px;height:8px;border-radius:50%;background:conic-gradient(from 200deg,var(--blue-300),var(--blue-600));box-shadow:0 0 0 4px rgba(26,102,255,.12);}
    .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
    .field .hint{font-size:12px;color:#5b6b86;margin-top:4px;}
    .checkwrap{border:1px dashed rgba(26,102,255,.28);padding:10px 12px;border-radius:12px;background:rgba(255,255,255,.6);}
    .submit-zone{display:flex;flex-direction:column;align-items:center;gap:8px;margin-top:6px;}
    @media(max-width:720px){.form-grid{grid-template-columns:1fr;}}
    .plan-wrap{display:flex;gap:10px;flex-wrap:wrap}
    .plan{display:flex;align-items:center;gap:8px;padding:10px 12px;border:1px solid rgba(26,102,255,.28);border-radius:12px;background:#fff;font-weight:700}
    .plan small{font-weight:600;color:#3a4b6a}
  </style>
</head>

<body>
  <div class="site">
    <header class="site-header">
      <div class="header-inner">
        <a href="index.html" class="brand" style="text-decoration:none;display:flex;align-items:center;gap:10px;">
          <img src="img/logo.png" alt="Vrijeplek logo" style="height:40px;" onerror="this.remove()">
          <span class="brand-name">Vrijeplek</span>
          <span class="brand-dot"></span>
        </a>
        <nav class="header-actions">
          <a class="nav-btn" href="waarom.html">Waarom Vrijeplek?</a>
          <a class="nav-btn" href="aanmelden.html" aria-current="page">Word lid</a>
          <a class="nav-btn" href="login.html">Login</a>
        </nav>
      </div>
    </header>

    <main>
      <section class="hero" style="padding:56px 0 40px;text-align:center;">
        <div class="container hero-inner">
          <h1 class="section-title">Meld je aan bij Vrijeplek</h1>
          <p style="max-width:700px;margin:0 auto 26px;color:#1f2a44;">
            Registreer je zaak. Kies maandelijks of jaarplan. Na e-mailbevestiging kom je in je dashboard.
          </p>

          <div class="search-wrap">
            <div class="card-head">
              <h2>Gegevens onderneming</h2>
              <span class="badge"><span class="badge-dot"></span> Verificatie vereist</span>
            </div>

            <form id="aanmelden-form" class="form-grid" novalidate>
              <input type="hidden" id="plan" name="plan" value="monthly">

              <div class="field" style="grid-column:1 / -1;">
                <label>Abonnement</label>
                <div class="plan-wrap">
                  <label class="plan"><input type="radio" name="planRadio" value="monthly" checked> €19,95/maand <small>maandelijks opzegbaar</small></label>
                  <label class="plan"><input type="radio" name="planRadio" value="yearly"> €180/jaar <small>3 maanden gratis</small></label>
                </div>
              </div>

              <div class="field" style="grid-column:1 / -1;">
                <label for="zaak">Naam van je zaak / contactpersoon</label>
                <input id="zaak" name="zaak" type="text" class="input" required autocomplete="organization" />
                <div class="hint">Gebruik de officiële handelsnaam of de naam die klanten herkennen.</div>
              </div>

              <div class="field">
                <label for="email">E-mailadres</label>
                <input id="email" name="email" type="email" class="input" required autocomplete="email" />
              </div>
              <div class="field">
                <label for="telefoon">Telefoon</label>
                <input id="telefoon" name="telefoon" type="tel" class="input" required autocomplete="tel" placeholder="+32 ..." />
              </div>

              <div class="field" style="grid-column:1 / -1;">
                <label for="btw">BTW-nummer <small style="font-weight:600;color:#475569;">(BE0123456789)</small></label>
                <input id="btw" name="btw" type="text" class="input" required pattern="^BE[0-9]{10}$" placeholder="BE0123456789" />
              </div>

              <div class="field">
                <label for="straat">Straat + nr.</label>
                <input id="straat" name="straat" type="text" class="input" required autocomplete="address-line1" />
              </div>
              <div class="field">
                <label for="postcode">Postcode & gemeente</label>
                <input id="postcode" name="postcode" type="text" class="input" required placeholder="3500 Hasselt" />
              </div>

              <div class="field">
                <label for="cat">Categorie</label>
                <select id="cat" name="cat" class="input">
                  <option value="">Kies een categorie</option>
                  <option value="horeca">Horeca</option>
                  <option value="wellness">Wellness</option>
                  <option value="zorg">Gezondheid</option>
                  <option value="events">Events</option>
                  <option value="poetsdiensten">Poetsdiensten</option>
                  <option value="ramenwasser">Ramenwasser</option>
                  <option value="dieren">Dieren</option>
                </select>
              </div>
              <div class="field">
                <label for="website">Website (optioneel)</label>
                <input id="website" name="website" type="url" class="input" placeholder="https://voorbeeld.be" />
                <div class="hint">Laat leeg of vul een volledige URL in (met https://).</div>
              </div>

              <div class="field" style="grid-column:1 / -1;">
                <label for="bio">Korte omschrijving (optioneel)</label>
                <input id="bio" name="bio" type="text" class="input" placeholder="Beschrijf kort je diensten of specialisaties" />
              </div>

              <div class="field checkwrap" style="grid-column:1 / -1; display:flex; align-items:flex-start; gap:10px;">
                <input id="voorwaarden" name="voorwaarden" type="checkbox" required style="margin-top:3px;">
                <label for="voorwaarden" style="font-size:14px; color:#0a0a0a; line-height:1.45;">Ik ga akkoord met de <a href="voorwaarden.html" style="color:var(--blue-700); font-weight:700;">algemene voorwaarden</a>.</label>
              </div>

              <div class="submit-zone" style="grid-column:1 / -1;">
                <button type="submit" class="btn" style="min-width:220px; height:46px;">Aanmelden</button>
                <div class="tiny-note">Na bevestiging van je e-mail kan je inloggen. Publiceren kan zodra je plan is geactiveerd.</div>
              </div>
            </form>
            <div id="msg" style="text-align:center;margin-top:8px;color:#0a2a4a;"></div>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="footer-inner">
        <p>© 2025 Vrijeplek. Alle rechten voorbehouden.</p>
        <nav class="footer-nav">
          <a href="voorwaarden.html">Algemene voorwaarden</a>
          <a href="#privacy">Privacy</a>
          <a href="#contact">Contact</a>
        </nav>
      </div>
    </footer>
  </div>

  <script>
    (function(){
      const qs = new URLSearchParams(location.search);
      const planParam = (qs.get('plan')||'').toLowerCase();
      const planInput = document.getElementById('plan');
      const radios = document.querySelectorAll('input[name="planRadio"]');
      if (planParam === 'yearly' || planParam === 'monthly'){
        radios.forEach(r=>{ r.checked = (r.value === planParam); });
        planInput.value = planParam;
      }
      radios.forEach(r=> r.addEventListener('change', ()=> planInput.value = r.value ));

      const btw = document.getElementById('btw');
      btw.addEventListener('input', ()=> btw.value = btw.value.toUpperCase().replace(/\s+/g,'') );

      const form = document.getElementById('aanmelden-form');
      const msg  = document.getElementById('msg');

      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        if (!form.checkValidity()){
          alert('Controleer de velden en accepteer de voorwaarden.');
          return;
        }
        const body = {
          plan: document.getElementById('plan').value,
          zaak: document.getElementById('zaak').value.trim(),
          email: document.getElementById('email').value.trim(),
          telefoon: document.getElementById('telefoon').value.trim(),
          btw: document.getElementById('btw').value.trim(),
          straat: document.getElementById('straat').value.trim(),
          postcode: document.getElementById('postcode').value.trim(),
          cat: document.getElementById('cat').value,
          website: document.getElementById('website').value.trim(),
          bio: document.getElementById('bio').value.trim(),
          password: crypto.getRandomValues(new Uint32Array(1))[0].toString(36) + "A#1"
        };
        msg.textContent = 'Versturen…';
        try{
          const r = await fetch('/.netlify/functions/signup',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});
          if (r.status === 303){ location.href = 'bedankt.html'; return; }
          const t = await r.text();
          msg.textContent = t || 'Er ging iets mis.';
        }catch(err){
          msg.textContent = 'Netwerkfout.';
        }
      });
    })();
  </script>
</body>
</html>
